function executeFunctionByName(a,b){for(var c=Array.prototype.slice.call(arguments).splice(2),d=a.split("."),e=d.pop(),f=0;d.length>f;f++)b=b[d[f]];return b[e].apply(this,c)}String.prototype.replaceAll=function(a,b){return this.replace(RegExp(a,"gm"),b)},!function(a){"use strict";function c(a){return{beforeCallback:a.attr("data-before-callback"),successCallback:a.attr("data-success-callback"),completeCallback:a.attr("data-complete-callback"),confirmInfo:a.attr("data-confirm"),replace_selector:a.attr("data-replace"),append_selector:a.attr("data-append"),dataType:a.attr("data-data-type"),refresh_selector:a.attr("data-refresh"),method:a.attr("data-method")}}function e(b,c){var e=1==c?d:!1;a(b).spin(e)}function f(a){var b=a.confirmInfo;b?void 0!=bootbox?bootbox.confirm(b,function(b){b&&g(a)}):confirm(b)&&g(a):g(a)}function g(b){b.replace_selector&&(b.el=a(b.replace_selector)),b.append_selector&&(b.el=a(b.append_selector),b.append=!0);var c=b.el,d=b.dataType,f=b.append,g=b.successCallback,j=b.refresh_selector,k=b.beforeCallback,l=b.completeCallback,m=!1,n=!1;a.ajax({url:b.url,type:b.method,data:b.data,success:function(b,e){"json"==d&&(1==b.replacePrevent&&(m=!0),b.refreshPrevent&&(n=!0)),m||("json"==d?b.html&&(f?c.append(b.html).bootAjaxLink().bootValidation():c.html(b.html).bootAjaxLink().bootValidation()):f?c.append(b).bootAjaxLink().bootValidation():c.html(b).bootAjaxLink().bootValidation()),"json"==d&&b.callback&&executeFunctionByName(b.callback,window,b.callbackParams?b.callbackParams:{}),g&&executeFunctionByName(g,window,b,e),j&&!n&&h(a(j))},beforeSend:function(a,b){c&&e(c,!0),k&&executeFunctionByName(k,window,a,b)},complete:function(a,b){c&&e(c,!1),l&&executeFunctionByName(l,window,a,b)},error:function(a){c&&e(c,!1),i(c,a)}})}function h(a){var b=c(a);b.el=a,b.url=a.data("refresh-url"),f(b)}function i(a,b,c){var d,e;e=404==b.status?"<strong>\u9519\u8bef\uff01</strong>HTTP 404-\u8bf7\u6c42\u7684\u9875\u9762\u4e0d\u5b58\u5728\u6216\u94fe\u63a5\u9519\u8bef":0==b.status?"<strong>\u9519\u8bef\uff01</strong> \u670d\u52a1\u65e0\u6548\uff0c\u8bf7\u68c0\u67e5\u670d\u52a1\u5668\u72b6\u6001":500==b.status?"<strong>\u9519\u8bef\uff01</strong>HTTP 500\u5185\u90e8\u670d\u52a1\u5668\u9519\u8bef":"<strong>\u9519\u8bef\uff01</strong>"+b.status,d=b.responseText;var f='<div class="modal-header"><button type="button" class="close" data-dismiss="modal">\u00d7</button><h3>'+e+'</h3></div><div class="modal-body">'+d+'</div><div class="modal-footer"><a href="#" class="btn btn-inverse" data-dismiss="modal"><i class="icon-off icon-white"></i>Close</a></div>';c?a.append(f):a.html(f)}var b=function(){};b.prototype.click=function(b){var d=a(this),e=d.attr("href"),g=d.attr("data-data"),h=c(d);h.method||(h.method="GET"),g&&(h.data=a.parseJSON(g.replaceAll("'",'"'))),h.url=e,b.preventDefault(),f(h)},b.prototype.submit=function(b){b.preventDefault();var d=a(this);b.data.duplicate||d.find("input[type=submit],button[type=submit]").attr("disabled","disabled");var e=c(d);e.url=d.attr("action"),e.data=d.serialize(),e.method||(e.method="POST"),f(e)};var d={radius:25,length:0,width:10,color:"#C40000",trail:40,zIndex:2};a.fn.bootAjax=function(b){b.el=a(this),f(b)},a.fn.bootAjaxLink=function(){var c=a(this);return c.find("a.ajax").bind("click",b.prototype.click),c},a.fn.bootAjaxForm=function(c){var d=a(this);return a(this).is("form")?d.bind("submit",{duplicate:c},b.prototype.submit):d.find("form.ajax").bind("submit",{duplicate:c},b.prototype.submit),d},a.fn.bootAjaxSubmit=function(b){var d=a(this);d.is("form")&&(b||(b={}),b=a.extend(c(d),b),b.url||(b.url=d.attr("action"),b.data=d.serialize()),b.data=d.serialize(),b.method||(b.method="POST"),f(b))},a(function(){a("body").bootAjaxLink()})}(window.jQuery);
