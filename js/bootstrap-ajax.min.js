String.prototype.replaceAll=function(a,b){return this.replace(RegExp(a,"gm"),b)},!function(a){"use strict";function c(a,b){for(var c=Array.prototype.slice.call(arguments).splice(2),d=a.split("."),e=d.pop(),f=0;d.length>f;f++)b=b[d[f]];return b[e].apply(this,c)}function d(b,d,e,f,h,k,l){a.ajax({url:e,type:d,data:f,success:function(a,d){i(a,b),k&&c(k,window,a,d)},beforeSend:function(a,d){g(b,!0),h&&c(h,window,a,d)},complete:function(a,d){g(b,!1),l&&c(l,window,a,d)},error:function(a){j(b,a)}})}function f(b,c){var d=1==c?e:!1;a(b).spin(d)}function g(a,b){var c=a.attr("data-replace"),d=a.attr("data-append");c&&f(c,b),d&&f(d,b)}function h(a,b){var c=a.attr("data-refresh");c&&f(c,b)}function i(b,d){if(b.location)window.location.href=b.location;else{var e=d.attr("data-replace"),f=d.attr("data-append"),g=d.attr("data-data-type"),i=d.attr("data-refresh");e&&("json"==g?a(e).html(b.html).bootAjax():a(e).html(b).bootAjax()),f&&("json"==g?a(f).append(b.html).bootAjax():a(f).append(b).bootAjax()),i&&a.each(a(i),function(b,d){var e=a(d).data("refresh-url"),f=a(d).attr("data-data"),g=a(d).attr("method"),i=a(d).attr("data-data-type"),j=a(d).attr("data-before-callback"),l=a(d).attr("data-success-callback"),m=a(d).attr("data-complete-callback");g||(g="GET"),f&&(f=a.parseJSON(f.replaceAll("'",'"'))),a.ajax({url:e,type:g,data:f,beforeSend:function(b,e){h(a(d),!0),j&&c(j,window,b,e)},success:function(b,e){"json"==i?a(d).html(b.html).bootAjax():a(d).html(b).bootAjax(),l&&c(l,window,b,e)},complete:function(b,e){h(a(d),!1),m&&c(m,window,b,e)},error:function(b){a(d).html(k(b))}})})}}function j(b,c){var d=k(c),e=b.attr("data-replace"),f=b.attr("data-append");e&&a(e).html(d),f&&a(f).append(d)}function k(a){var b="";return b=404==a.status?"<strong>\u9519\u8bef\uff01</strong>HTTP 404-\u8bf7\u6c42\u7684\u9875\u9762\u4e0d\u5b58\u5728\u6216\u94fe\u63a5\u9519\u8bef":0==a.status?"<strong>\u9519\u8bef\uff01</strong> \u670d\u52a1\u65e0\u6548\uff0c\u8bf7\u68c0\u67e5\u670d\u52a1\u5668\u72b6\u6001":500==a.status?"<strong>\u9519\u8bef\uff01</strong>HTTP 500\u5185\u90e8\u670d\u52a1\u5668\u9519\u8bef":"\u9519\u8bef\u4ee3\u53f7:"+a.status+" \u9519\u8bef\u4fe1\u606f\uff1a"+a.statusText,'<div class="alert alert-error">'+b+"</div>"}var b=function(){};b.prototype.click=function(b){var c=a(this),e=c.attr("href"),f=c.attr("data-data"),g=c.attr("data-method"),h=c.attr("data-before-callback"),i=c.attr("data-success-callback"),j=c.attr("data-complete-callback"),k=c.attr("data-confirm");g||(g="get"),f&&(f=a.parseJSON(f.replaceAll("'",'"'))),b.preventDefault(),k?confirm(k)&&d(c,g,e,f,h,i,j):d(c,g,e,f,h,i,j)},b.prototype.submit=function(b){var c=a(this),e=c.attr("action"),f=c.serialize(),g=c.attr("method"),h=c.attr("data-before-callback"),i=c.attr("data-success-callback"),j=c.attr("data-complete-callback");c.find("input[type=submit],button[type=submit]").attr("disabled","disabled"),b.preventDefault(),d(c,g,e,f,h,i,j)},b.prototype.cancel=function(b){var c=a(this),d=c.attr("data-cancel-closest");b.preventDefault(),c.closest(d).remove()};var e={radius:30,length:0,width:10,color:"#C40000",trail:40};a.fn.bootAjax=function(){return this.each(function(){var c=a(this);c.find("a.ajax").bind("click",b.prototype.click),c.find("form.ajax").bind("submit",b.prototype.submit),c.find("a[data-cancel-closest]").bind("click",b.prototype.cancel)})},a(function(){a("body").bootAjax()})}(window.jQuery);
